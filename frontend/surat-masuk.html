<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Surat Masuk</title>
  <!-- Tell the browser to be responsive to screen width -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="./plugins/fontawesome-free/css/all.min.css">
  <!-- Ionicons -->
  <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
  <!-- DataTables -->
  <link rel="stylesheet" href="./plugins/datatables-bs4/css/dataTables.bootstrap4.min.css">
  <link rel="stylesheet" href="./plugins/datatables-responsive/css/responsive.bootstrap4.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="./dist/css/adminlte.min.css">
  <!-- Google Font: Source Sans Pro -->
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">
  <script src='apiflask.js'></script>
<script>
  fetchProtectedData();
</script>
</head>
<body class="hold-transition sidebar-mini">
<div class="wrapper">
  <!-- Navbar -->
  <nav class="main-header navbar navbar-expand navbar-white navbar-light" style="background-color: #2091d9;">
    <!-- Left navbar links -->
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
      </li>
    </ul>
    <ul class="navbar-nav ml-auto">
      <li class="nav-item">
        <a class="nav-link btn" onclick="keluar()" style="color: white; font-weight: bold; padding: 10px 15px; background-color: #ff4d4d; border-radius: 5px;">
          <i class="fas fa-sign-out-alt"></i> Logout
        </a>
      </li>
    </ul>
  </nav>
  <!-- /.navbar -->

  <!-- Main Sidebar Container -->
  <aside class="main-sidebar sidebar-dark-primary elevation-4" style="background: linear-gradient(#333333, #262626 95%, #0d0d0d);">
    <!-- Brand Logo -->
    <a href="index.html" class="brand-link">
      <!-- LOGO -->
      <img src="./img/logo surat.jpeg" alt="AdminLTE Logo" class="brand-image img-circle elevation-3" style="opacity: .8">
      <span class="brand-text font-weight-light">DS Correspondence</span>
    </a>

    <!-- Sidebar -->
    <div class="sidebar">
      <!-- Sidebar user panel (optional) -->

      <!-- Sidebar Menu -->
      <nav class="mt-2">
        <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
          <li>
            <a href="./index.html" class="nav-link active">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house-fill" viewBox="0 0 16 16">
                <path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L8 2.207l6.646 6.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293z"/>
                <path d="m8 3.293 6 6V13.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5V9.293l6-6Z"/>
              </svg>
              <p>
                Home
              </p>
            </a>
          </li>
          <li class="nav-item">
            <a href="./info-surat.html" class="nav-link">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-envelope-fill" viewBox="0 0 16 16">
                <path d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555ZM0 4.697v7.104l5.803-3.558zM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586l-1.239-.757Zm3.436-.586L16 11.801V4.697l-5.803 3.546Z"/>
              </svg>
              <p>
                Info Surat
              </p>
            </a>
          </li>
          <li class="nav-item has-treeview">
            <a href="kalender.html" class="nav-link">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar-check-fill" viewBox="0 0 16 16">
                <path d="M4 .5a.5.5 0 0 0-1 0V1H2a2 2 0 0 0-2 2v1h16V3a2 2 0 0 0-2-2h-1V.5a.5.5 0 0 0-1 0V1H4zM16 14V5H0v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2m-5.146-5.146-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708z"/>
              </svg>
              <p>
                Kalender BPH
              </p>
            </a>
          </li>
          <li class="nav-item has-treeview">
            <a href="galeri.html" class="nav-link">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-card-image" viewBox="0 0 16 16">
                <path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"/>
                <path d="M1.5 2A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2zm13 1a.5.5 0 0 1 .5.5v6l-3.775-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12v.54A.505.505 0 0 1 1 12.5v-9a.5.5 0 0 1 .5-.5z"/>
              </svg>
              <p>
                Galeri
              </p>
            </a>
          </li>
        </ul>
      </nav>
      <!-- /.sidebar-menu -->
    </div>
    <!-- /.sidebar -->
  </aside>

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <div class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1 class="m-0 text-dark">Surat Masuk</h1>
          </div><!-- /.col -->
          <div class="col-sm-6">
          </div><!-- /.col -->
        </div><!-- /.row -->
      </div><!-- /.container-fluid -->
    </div>
    <!-- /.content-header -->

    <!-- Main content -->
    <section class="content">
      <div class="row">
        <div class="col-12">
          <div class="card">
            <!-- /.card-header -->
            <div class="card-body">
              <!-- Tambahkan tombol Tambah -->
              <button id="tambahBtn" class="btn btn-primary mb-2" data-toggle="modal" data-target="#modalTambah">Tambah</button>
              
              <table id="example2" class="table table-bordered table-hover">
                <thead>
                  <tr>
                    <th>Nomor</th>
                    <th>Tanggal</th>
                    <th>Perihal</th>
                    <th>Asal</th>
                    <th>File</th>
                    <th>Aksi</th>
                  </tr>
                </thead>
                <tbody>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                </tr>
                </tfoot>
              </table>
            </div>
            <!-- /.card-body -->
          </div>
          <!-- /.card -->
        </div>
        <!-- /.col -->
      </div>
      <!-- /.row -->
    </section>
    <!-- /.content -->

    <!-- Modal Tambah -->
<div class="modal fade" id="modalTambah" tabindex="-1" role="dialog" aria-labelledby="modalTambahLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalTambahLabel">Tambah Data</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <!-- Form untuk input data -->
        <form id="formTambah">
          <div class="form-group">
            <label for="nomor">Nomor Surat:</label>
            <input type="text" class="form-control" id="nomor" required>
          </div>
          <div class="form-group">
            <label for="tanggal">Tanggal:</label>
            <input type="date" class="form-control" id="tanggal" required>
          </div>
          <div class="form-group">
            <label for="perihal">Perihal:</label>
            <input type="text" class="form-control" id="perihal" required>
          </div>
          <div class="form-group">
            <label for="tujuan">Asal:</label>
            <input type="text" class="form-control" id="tujuan" required>
          </div>
          <div class="form-group">
            <label for="file">File:</label>
            <input type="file" class="form-control" id="file" required>
          </div>
          <button type="submit" class="btn btn-primary">Submit</button>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Modal Edit -->
<div class="modal fade" id="modalEdit" tabindex="-1" role="dialog" aria-labelledby="modalEditLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalEditLabel">Edit Data</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <!-- Form untuk edit data -->
        <form id="formEdit">
          <div class="form-group">
            <label for="editNomor">Nomor Surat:</label>
            <input type="text" class="form-control" id="editNomor" required>
          </div>
          <div class="form-group">
            <label for="editTanggal">Tanggal:</label>
            <input type="date" class="form-control" id="editTanggal" required>
          </div>
          <div class="form-group">
            <label for="editPerihal">Perihal:</label>
            <input type="text" class="form-control" id="editPerihal" required>
          </div>
          <div class="form-group">
            <label for="editTujuan">Asal:</label>
            <input type="text" class="form-control" id="editTujuan" required>
          </div>
          <div class="form-group">
            <label for="editFile">File:</label>
            <input type="file" class="form-control" id="editFile" required>
          </div>
          <button type="submit" class="btn btn-primary">Submit</button>
        </form>
      </div>
    </div>
  </div>
</div>

  </div>
  <!-- /.content-wrapper -->
  <footer class="main-footer" style="text-align: center;">
    <strong>Copyright &copy; 2023 
      <!-- <a href="http://adminlte.io">AdminLTE.io</a>.</strong> -->
    BPH Coconut Computer Club.
  </footer>

  <!-- Control Sidebar -->
  <aside class="control-sidebar control-sidebar-dark">
    <!-- Control sidebar content goes here -->
  </aside>
  <!-- /.control-sidebar -->
</div>
<!-- ./wrapper -->

<!-- jQuery -->
<script src="./plugins/jquery/jquery.min.js"></script>
<!-- Bootstrap 4 -->
<script src="./plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- DataTables -->
<script src="./plugins/datatables/jquery.dataTables.min.js"></script>
<script src="./plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
<script src="./plugins/datatables-responsive/js/dataTables.responsive.min.js"></script>
<script src="./plugins/datatables-responsive/js/responsive.bootstrap4.min.js"></script>
<!-- AdminLTE App -->
<script src="./dist/js/adminlte.min.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="./dist/js/demo.js"></script>
<!-- page script -->
<script>
  $(function () {
    $("#example1").DataTable({
      "responsive": true,
      "autoWidth": false,
    });
    $('#example2').DataTable({
      "paging": true,
      "lengthChange": false,
      "searching": false,
      "ordering": true,
      "info": true,
      "autoWidth": false,
      "responsive": true,
    });
  });
</script>
</body>

<!-- Tambahkan skrip jQuery dan Bootstrap JS (jika belum ada) -->
<!-- <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.min.js"></script> -->

<script>
  $(document).ready(function () {
    // Load data from localStorage if available
    var storedData = localStorage.getItem('suratData');
    var data = storedData ? JSON.parse(storedData) : [];

    function renderTable() {
      var tbody = $('#example2 tbody');
      tbody.empty();

      data.forEach(function (item, index) {
        var row = '<tr>' +
          '<td>' + item.nomor + '</td>' +
          '<td>' + item.tanggal + '</td>' +
          '<td>' + item.perihal + '</td>' +
          '<td>' + item.tujuan + '</td>' +
          '<td><a href="#" onclick="viewFile(\'' + item.file + '\')">Lihat</a></td>' +
          '<td>' +
          '<button class="btn btn-warning btn-sm" onclick="editRowMasuk(index)" data-toggle="modal" data-target="#modalEdit">Edit</button> ' +
          '<button class="btn btn-danger btn-sm" onclick="confirmDelete(' + index + ')">Hapus</button>' +
          '</td>' +
          '</tr>';

        tbody.append(row);
      });
    }

    $('#formTambah').submit(function (e) {
      e.preventDefault();

      var nomor = $('#nomor').val();
      var tanggal = $('#tanggal').val();
      var perihal = $('#perihal').val();
      var tujuan = $('#tujuan').val();
      var file = $('#file').val();

      data.push({ nomor: nomor, tanggal: tanggal, perihal: perihal, tujuan: tujuan, file: file });

      // Save data to localStorage
      localStorage.setItem('suratData', JSON.stringify(data));

      renderTable();

      $('#modalTambah').modal('toggle');
      $('#formTambah')[0].reset();
    });

    window.editRow = function (index) {
      // Implement edit logic here
      // Set form values based on the selected data
      $('#editIndex').val(index);
      $('#editNomor').val(data[index].nomor);
      $('#editTanggal').val(data[index].tanggal);
      $('#editPerihal').val(data[index].perihal);
      $('#editTujuan').val(data[index].tujuan);
      $('#editFile').val(data[index].file);

      // Open the edit modal
      $('#modalEdit').modal('show');
    };

    $('#formEdit').submit(function (e) {
      e.preventDefault();

      // Implementasikan logika untuk memperbarui data pada index tertentu
      var indexToEdit = $('#editIndex').val();
      data[indexToEdit] = {
        nomor: $('#editNomor').val(),
        tanggal: $('#editTanggal').val(),
        perihal: $('#editPerihal').val(),
        tujuan: $('#editTujuan').val(),
        file: $('#editFile').val()
      };

      // Save updated data to localStorage
      localStorage.setItem('suratData', JSON.stringify(data));

      renderTable();

      $('#modalEdit').modal('toggle');
      $('#formEdit')[0].reset();

      // Clear the editIndex value
      $('#editIndex').val('');
    });

    window.confirmDelete = function (index) {
      if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
        deleteRow(index);
      }
    };

    function deleteRow(index) {
      data.splice(index, 1);

      // Save updated data to localStorage
      localStorage.setItem('suratData', JSON.stringify(data));

      renderTable();
    }

    // Function to view file (you can customize this based on your requirements)
    window.viewFile = function (filePath) {
      // Implement logic to view the file, for example, open a new window or a modal
      window.open(filePath, '_blank');
    };

    renderTable();
  });
</script>



</html>
